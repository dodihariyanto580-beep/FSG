<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Dampak Ekonomi | KEK Batang</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js for interactive charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chart.js Datalabels plugin for displaying values on charts -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        .kpi-card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
    </style>
</head>
<body class="antialiased text-gray-800">

    <div id="dashboard-container" class="min-h-screen">

        <!-- Header Section -->
        <header class="bg-white shadow-md sticky top-0 z-20">
            <div class="container mx-auto px-6 py-4 flex justify-between items-center">
                <div class="flex items-center space-x-3">
                    <div class="bg-blue-600 p-2 rounded-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" x2="12" y1="20" y2="4"/><path d="M6 20v-7"/><path d="M18 20v-4"/></svg>
                    </div>
                    <h1 id="dashboard-title" class="text-xl md:text-2xl font-bold text-gray-900">Dashboard Dampak Ekonomi KEK Batang</h1>
                </div>
                <div class="flex items-center gap-4">
                     <span id="company-name" class="text-sm font-medium text-gray-500 hidden md:block">PT FondFashion Seamless Garment (FSG)</span>
                     <div class="flex items-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-gray-500"><path d="m5 8 6 6"/><path d="m4 14 6-6 2-3"/><path d="M2 5h12"/><path d="M7 2h1"/><path d="m22 22-5-10-5 10"/><path d="M14 18h6"/></svg>
                        <select id="language-selector" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 p-2">
                            <option value="id">Bahasa Indonesia</option>
                            <option value="en">English</option>
                            <option value="zh">中文 (Mandarin)</option>
                        </select>
                     </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="container mx-auto p-4 md:p-6 space-y-6">
            
            <!-- Filters Section -->
            <div class="bg-white p-4 rounded-xl shadow-sm flex flex-col md:flex-row items-center gap-4">
                <h2 id="filter-title" class="text-lg font-semibold text-gray-700 flex-shrink-0">Filter Data:</h2>
                <div class="flex items-center gap-2 w-full md:w-auto">
                    <label id="year-label" for="year-filter" class="font-medium text-sm">Tahun:</label>
                    <select id="year-filter" class="w-full bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 p-2">
                        <option id="year-option-all" value="all">Semua Tahun (2025-2031)</option>
                        <option value="2025">2025</option>
                        <option value="2026">2026</option>
                        <option value="2027">2027</option>
                        <option value="2028" selected>2028</option>
                        <option value="2029">2029</option>
                        <option value="2030">2030</option>
                        <option value="2031">2031</option>
                    </select>
                </div>
                <div class="flex items-center gap-2 w-full md:w-auto">
                    <label id="scenario-label" for="scenario-filter" class="font-medium text-sm">Skenario:</label>
                    <select id="scenario-filter" class="w-full bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 p-2">
                        <option id="scenario-baseline" value="baseline">Baseline</option>
                        <option id="scenario-optimistic" value="optimistic">Optimistic</option>
                        <option id="scenario-conservative" value="conservative">Conservative</option>
                    </select>
                </div>
            </div>

            <!-- KPI Cards Section -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6">
                <div class="kpi-card bg-white p-6 rounded-xl shadow-sm flex items-start justify-between">
                    <div>
                        <h3 id="kpi-capex-title" class="text-base font-medium text-gray-500">Total Investasi (CAPEX)</h3>
                        <p id="kpi-capex" class="text-3xl font-bold text-gray-900 mt-2">Rp 276.15 M</p>
                        <p id="kpi-capex-subtitle" class="text-sm text-gray-400 mt-1">Investasi Proyek</p>
                    </div>
                    <div class="bg-blue-100 text-blue-600 p-3 rounded-lg">
                       <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M3 5v14a9 3 0 0 0 9 3 9 3 0 0 0 9-3V5"/><path d="M3 12A9 3 0 0 0 12 15a9 3 0 0 0 9-3"/><path d="M18 16l-4 4h6l-4 4"/></svg>
                    </div>
                </div>
                <div class="kpi-card bg-white p-6 rounded-xl shadow-sm flex items-start justify-between">
                    <div>
                        <h3 id="kpi-workforce-title" class="text-base font-medium text-gray-500">Tenaga Kerja Langsung</h3>
                        <p id="kpi-workforce" class="text-3xl font-bold text-gray-900 mt-2">2.500</p>
                        <p id="kpi-workforce-subtitle" class="text-sm text-gray-400 mt-1">Total Karyawan</p>
                    </div>
                     <div class="bg-green-100 text-green-600 p-3 rounded-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                    </div>
                </div>
                <div class="kpi-card bg-white p-6 rounded-xl shadow-sm flex items-start justify-between">
                    <div>
                        <h3 id="kpi-export-title" class="text-base font-medium text-gray-500">Nilai Ekspor</h3>
                        <p id="kpi-export" class="text-3xl font-bold text-gray-900 mt-2">Rp 155.32 M</p>
                        <p id="kpi-export-subtitle" class="text-sm text-gray-400 mt-1">Pendapatan Global</p>
                    </div>
                     <div class="bg-orange-100 text-orange-600 p-3 rounded-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.5 0 2.5 2 5 2 1.3 0 1.9-.5 2.5-1"/><path d="M19.38 20.71A10.4 10.4 0 0 1 19 18.26C19 14 18 10 12 2 6 10 5 14 5 18.26a10.4 10.4 0 0 1-.38 2.45"/><path d="M12 2v20"/></svg>
                    </div>
                </div>
                <div class="kpi-card bg-white p-6 rounded-xl shadow-sm flex items-start justify-between">
                    <div>
                        <h3 id="kpi-tax-title" class="text-base font-medium text-gray-500">Pajak Karyawan (PPh 21)</h3>
                        <p id="kpi-tax" class="text-3xl font-bold text-gray-900 mt-2">Rp 1.49 M</p>
                        <p id="kpi-tax-subtitle" class="text-sm text-gray-400 mt-1">Kontribusi Pajak</p>
                    </div>
                     <div class="bg-red-100 text-red-600 p-3 rounded-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m13 11 8-8"/><path d="m21 3-3.3 3.3"/><path d="M3 21a2 2 0 0 0 2.8 0l1.4-1.4a2 2 0 0 0 0-2.8l-1.4-1.4a2 2 0 0 0-2.8 0z"/><path d="M10 14 3.3 7.3a2 2 0 0 0-2.8 0L.5 8.7a2 2 0 0 0 0 2.8l1.4 1.4a2 2 0 0 0 2.8 0l1.4-1.4"/></svg>
                    </div>
                </div>
                <div class="kpi-card bg-white p-6 rounded-xl shadow-sm flex items-start justify-between">
                    <div>
                        <h3 id="kpi-multiplier-title" class="text-base font-medium text-gray-500">Output Regional</h3>
                        <p id="kpi-multiplier" class="text-3xl font-bold text-gray-900 mt-2">Rp 70.97 M</p>
                         <p id="kpi-multiplier-subtitle" class="text-sm text-gray-400 mt-1">Multiplier Effect</p>
                    </div>
                     <div class="bg-purple-100 text-purple-600 p-3 rounded-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7 19H4.92a2 2 0 0 1-1.82-2.78L5 12V9c0-1.1.9-2 2-2h1c.55 0 1 .45 1 1v1c0 .55-.45 1-1 1H7v2l4-3 4 3v-2h-1c-.55 0-1-.45-1-1V9c0-.55.45-1 1-1h1c1.1 0 2 .9 2 2v3l1.9 4.22A2 2 0 0 1 19.08 19H17"/><path d="M5 12h14"/></svg>
                    </div>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="grid grid-cols-1 lg:grid-cols-5 gap-6">
                <div class="lg:col-span-3 bg-white p-6 rounded-xl shadow-sm">
                    <h3 id="chart-trend-title" class="text-lg font-semibold text-gray-700 mb-4">Tren Dampak Ekonomi Tahunan</h3>
                    <div class="h-96"><canvas id="economicTrendChart"></canvas></div>
                </div>
                <div class="lg:col-span-2 space-y-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm">
                        <h3 id="chart-workforce-title" class="text-lg font-semibold text-gray-700 mb-4">Komposisi Tenaga Kerja</h3>
                        <div class="h-60"><canvas id="workforceCompositionChart"></canvas></div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm">
                        <h3 id="chart-export-title" class="text-lg font-semibold text-gray-700 mb-4">Nilai Ekspor per Pasar Tujuan</h3>
                        <div class="h-60"><canvas id="exportMarketChart"></canvas></div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // --- DATA SIMULATION ---
        // Data has been updated based on the new workforce projection
        const baseData = {
            '2025': { workforce: 300, exportValue: 0, payroll: 0, employeeTax: 0, regionalOutput: 0, markets: { US: 0, EU: 0, Japan: 0, ASEAN: 0 }, workforceComposition: [0.70, 0.15, 0.08, 0.05, 0.02], capex: 276150000000 },
            '2026': { workforce: 1500, exportValue: 94259700000, payroll: 54260400000, employeeTax: 1489590000, regionalOutput: 40150000000, markets: { US: 27337500000, EU: 30712500000, Japan: 15214500000, ASEAN: 20995200000 }, workforceComposition: [0.70, 0.15, 0.08, 0.05, 0.02], capex: 0 },
            '2027': { workforce: 2000, exportValue: 126299250000, payroll: 55888212000, employeeTax: 2125941600, regionalOutput: 55200000000, markets: { US: 41006250000, EU: 30712500000, Japan: 15214500000, ASEAN: 39366000000 }, workforceComposition: [0.70, 0.15, 0.08, 0.05, 0.02], capex: 0 },
            '2028': { workforce: 2000, exportValue: 155324250000, payroll: 46051890048, employeeTax: 2321058662, regionalOutput: 56776000000, markets: { US: 54675000000, EU: 46068750000, Japan: 15214500000, ASEAN: 39366000000 }, workforceComposition: [0.70, 0.15, 0.08, 0.05, 0.02], capex: 0 },
            '2029': { workforce: 2000, exportValue: 166715550000, payroll: 47412465623, employeeTax: 2485718884, regionalOutput: 59818975670, markets: { US: 54675000000, EU: 52211250000, Japan: 15214500000, ASEAN: 44614800000 }, workforceComposition: [0.70, 0.15, 0.08, 0.05, 0.02], capex: 0 },
            '2030': { workforce: 2500, exportValue: 221906250000, payroll: 61080326388, employeeTax: 3330129614, regionalOutput: 79796587804, markets: { US: 68343750000, EU: 76781250000, Japan: 22821750000, ASEAN: 53960000000 }, workforceComposition: [0.70, 0.15, 0.08, 0.05, 0.02], capex: 0 },
            '2031': { workforce: 2800, exportValue: 247065000000, payroll: 70450996000, employeeTax: 3989140493, regionalOutput: 95444118892, markets: { US: 82012500000, EU: 82923750000, Japan: 22821750000, ASEAN: 59307000000 }, workforceComposition: [0.70, 0.15, 0.08, 0.05, 0.02], capex: 0 },
        };

        const scenarioMultipliers = {
            baseline: { export: 1, regionalOutput: 1, workforce: 1, tax: 1 },
            optimistic: { export: 1.05, regionalOutput: 1.05, workforce: 1, tax: 1.05 },
            conservative: { export: 0.95, regionalOutput: 0.95, workforce: 1, tax: 0.95 }
        };

        // --- LANGUAGE TRANSLATIONS ---
        const translations = {
            id: {
                dashboardTitle: "Dashboard Dampak Ekonomi KEK Batang",
                companyName: "PT FondFashion Seamless Garment (FSG)",
                filterTitle: "Filter Data:",
                yearLabel: "Tahun:",
                yearOptionAll: "Semua Tahun (2025-2031)",
                scenarioLabel: "Skenario:",
                scenarioBaseline: "Baseline",
                scenarioOptimistic: "Optimistic",
                scenarioConservative: "Conservative",
                kpiCapexTitle: "Total Investasi (CAPEX)",
                kpiCapexSubtitle: "Investasi Proyek",
                kpiWorkforceTitle: "Tenaga Kerja Langsung",
                kpiWorkforceSubtitle: "Total Karyawan",
                kpiExportTitle: "Nilai Ekspor",
                kpiExportSubtitle: "Pendapatan Global",
                kpiTaxTitle: "Pajak Karyawan (PPh 21)",
                kpiTaxSubtitle: "Kontribusi Pajak",
                kpiMultiplierTitle: "Output Regional",
                kpiMultiplierSubtitle: "Multiplier Effect",
                chartTrendTitle: "Tren Dampak Ekonomi Tahunan",
                chartWorkforceTitle: "Komposisi Tenaga Kerja",
                chartExportTitle: "Nilai Ekspor per Pasar Tujuan",
                trendLabelExport: "Nilai Ekspor",
                trendLabelPayroll: "Gaji Tahunan",
                trendLabelTax: "Pajak Karyawan (PPh 21)",
                workforceLabels: ['Operator', 'Staf', 'Supervisor', 'Manajer', 'Manajer Senior'],
                exportTooltipLabel: "Nilai Ekspor"
            },
            en: {
                dashboardTitle: "KEK Batang Economic Impact Dashboard",
                companyName: "PT FondFashion Seamless Garment (FSG)",
                filterTitle: "Filters:",
                yearLabel: "Year:",
                yearOptionAll: "All Years (2025-2031)",
                scenarioLabel: "Scenario:",
                scenarioBaseline: "Baseline",
                scenarioOptimistic: "Optimistic",
                scenarioConservative: "Conservative",
                kpiCapexTitle: "Total Investment (CAPEX)",
                kpiCapexSubtitle: "Project Investment",
                kpiWorkforceTitle: "Direct Workforce",
                kpiWorkforceSubtitle: "Total Employees",
                kpiExportTitle: "Export Value",
                kpiExportSubtitle: "Global Revenue",
                kpiTaxTitle: "Employee Tax (PPh 21)",
                kpiTaxSubtitle: "Tax Contribution",
                kpiMultiplierTitle: "Regional Output",
                kpiMultiplierSubtitle: "Multiplier Effect",
                chartTrendTitle: "Annual Economic Impact Trends",
                chartWorkforceTitle: "Workforce Composition",
                chartExportTitle: "Export Value by Market Destination",
                trendLabelExport: "Export Value",
                trendLabelPayroll: "Annual Payroll",
                trendLabelTax: "Employee Tax (PPh 21)",
                workforceLabels: ['Operator', 'Staff', 'Supervisor', 'Manager', 'Senior Manager'],
                exportTooltipLabel: "Export Value"
            },
            zh: {
                dashboardTitle: "巴塘经济特区经济影响仪表板",
                companyName: "PT FondFashion Seamless Garment (FSG)",
                filterTitle: "筛选:",
                yearLabel: "年份:",
                yearOptionAll: "所有年份 (2025-2031)",
                scenarioLabel: "情景:",
                scenarioBaseline: "基线",
                scenarioOptimistic: "乐观",
                scenarioConservative: "保守",
                kpiCapexTitle: "总投资 (CAPEX)",
                kpiCapexSubtitle: "项目投资",
                kpiWorkforceTitle: "直接劳动力",
                kpiWorkforceSubtitle: "总员工",
                kpiExportTitle: "出口额",
                kpiExportSubtitle: "全球收入",
                kpiTaxTitle: "员工税 (PPh 21)",
                kpiTaxSubtitle: "税收贡献",
                kpiMultiplierTitle: "区域产出",
                kpiMultiplierSubtitle: "乘数效应",
                chartTrendTitle: "年度经济影响趋势",
                chartWorkforceTitle: "劳动力构成",
                chartExportTitle: "按市场目的地划分的出口额",
                trendLabelExport: "出口额",
                trendLabelPayroll: "年度工资",
                trendLabelTax: "员工税 (PPh 21)",
                workforceLabels: ['操作员', '职员', '主管', '经理', '高级经理'],
                exportTooltipLabel: "出口额"
            }
        };

        const generateScenarioData = (scenario) => {
            const multipliers = scenarioMultipliers[scenario];
            const scenarioData = {};
            for (const year in baseData) {
                scenarioData[year] = { ...baseData[year],
                    workforce: Math.round(baseData[year].workforce * multipliers.workforce),
                    exportValue: baseData[year].exportValue * multipliers.export,
                    employeeTax: baseData[year].employeeTax * multipliers.tax,
                    regionalOutput: baseData[year].regionalOutput * multipliers.regionalOutput,
                };
            }
            return scenarioData;
        };

        const formatCurrencyIDR = (value) => {
            if (Math.abs(value) >= 1e12) return `Rp ${(value / 1e12).toFixed(2)} T`;
            if (Math.abs(value) >= 1e9) return `Rp ${(value / 1e9).toFixed(2)} M`;
            if (Math.abs(value) >= 1e6) return `Rp ${(value / 1e6).toFixed(2)} Jt`;
            return `Rp ${new Intl.NumberFormat('id-ID').format(value)}`;
        };
        const formatNumber = (value) => new Intl.NumberFormat('id-ID').format(value);

        Chart.defaults.font.family = 'Inter';
        Chart.register(ChartDataLabels);
        let trendChart, workforceChart, exportChart;

        const professionalPalette = { blue: '#3b82f6', green: '#10b981', orange: '#f97316', purple: '#8b5cf6', red: '#ef4444', gray: '#6b7280', lightBlue: 'rgba(59, 130, 246, 0.1)' };

        const createTrendChart = (data, lang) => {
            const ctx = document.getElementById('economicTrendChart').getContext('2d');
            const t = translations[lang];
            const gradientExport = ctx.createLinearGradient(0, 0, 0, 400); gradientExport.addColorStop(0, 'rgba(59, 130, 246, 0.5)'); gradientExport.addColorStop(1, 'rgba(59, 130, 246, 0)');
            const gradientPayroll = ctx.createLinearGradient(0, 0, 0, 400); gradientPayroll.addColorStop(0, 'rgba(16, 185, 129, 0.5)'); gradientPayroll.addColorStop(1, 'rgba(16, 185, 129, 0)');
            const gradientTax = ctx.createLinearGradient(0, 0, 0, 400); gradientTax.addColorStop(0, 'rgba(239, 68, 68, 0.5)'); gradientTax.addColorStop(1, 'rgba(239, 68, 68, 0)');

            if (trendChart) trendChart.destroy();
            trendChart = new Chart(ctx, {
                type: 'line',
                data: { labels: Object.keys(data),
                    datasets: [
                        { label: t.trendLabelExport, data: Object.values(data).map(d => d.exportValue), backgroundColor: gradientExport, borderColor: professionalPalette.blue, borderWidth: 2.5, pointBackgroundColor: professionalPalette.blue, tension: 0.4, fill: true },
                        { label: t.trendLabelPayroll, data: Object.values(data).map(d => d.payroll), backgroundColor: gradientPayroll, borderColor: professionalPalette.green, borderWidth: 2.5, pointBackgroundColor: professionalPalette.green, tension: 0.4, fill: true },
                        { label: t.trendLabelTax, data: Object.values(data).map(d => d.employeeTax), backgroundColor: gradientTax, borderColor: professionalPalette.red, borderWidth: 2.5, pointBackgroundColor: professionalPalette.red, tension: 0.4, fill: true }
                    ]
                },
                options: { responsive: true, maintainAspectRatio: false,
                    scales: { y: { beginAtZero: true, grid: { color: '#e5e7eb' }, ticks: { callback: (value) => formatCurrencyIDR(value).replace('Rp ', '') } }, x: { grid: { display: false } } },
                    plugins: { legend: { position: 'top', align: 'end' }, tooltip: { callbacks: { label: (c) => `${c.dataset.label}: ${formatCurrencyIDR(c.raw)}` } } }
                }
            });
        };

        const createWorkforceChart = (data, lang) => {
            const ctx = document.getElementById('workforceCompositionChart').getContext('2d');
            const t = translations[lang];
            const totalWorkforce = data.workforce;
            const compositionData = data.workforceComposition.map(p => Math.round(p * totalWorkforce));
            
            if (workforceChart) workforceChart.destroy();
            workforceChart = new Chart(ctx, {
                type: 'doughnut',
                data: { labels: t.workforceLabels,
                    datasets: [{ data: compositionData, backgroundColor: [professionalPalette.blue, professionalPalette.green, professionalPalette.orange, professionalPalette.red, professionalPalette.purple], hoverOffset: 8, borderWidth: 0 }]
                },
                options: { responsive: true, maintainAspectRatio: false, cutout: '65%',
                    plugins: { legend: { display: false }, tooltip: { callbacks: { label: (c) => { const percentage = totalWorkforce > 0 ? ((c.raw / totalWorkforce) * 100).toFixed(1) : 0; return ` ${c.label}: ${formatNumber(c.raw)} (${percentage}%)`; } } } }
                }
            });
        };
        
        const createExportChart = (data, lang) => {
            const ctx = document.getElementById('exportMarketChart').getContext('2d');
             const t = translations[lang];
            if (exportChart) exportChart.destroy();
            exportChart = new Chart(ctx, {
                type: 'bar',
                data: { labels: Object.keys(data.markets),
                    datasets: [{ data: Object.values(data.markets), backgroundColor: professionalPalette.lightBlue, borderColor: professionalPalette.blue, borderWidth: 1 }]
                },
                options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false,
                    scales: { x: { ticks: { callback: (value) => formatCurrencyIDR(value).replace('Rp ', '') } }, y: { grid: { display: false } } },
                    plugins: { legend: { display: false },
                        tooltip: { callbacks: { label: (c) => `${t.exportTooltipLabel}: ${formatCurrencyIDR(c.raw)}` } },
                        datalabels: { anchor: 'end', align: 'end',
                            formatter: (value) => value > 0 ? formatCurrencyIDR(value) : '',
                            font: { size: 10, weight: '500' }, color: professionalPalette.gray
                        }
                    }
                }
            });
        };

        const updateDashboard = () => {
            const year = document.getElementById('year-filter').value;
            const scenario = document.getElementById('scenario-filter').value;
            const lang = document.getElementById('language-selector').value;
            const currentData = generateScenarioData(scenario);

            if (year === 'all') {
                const totalExport = Object.values(currentData).reduce((sum, d) => sum + d.exportValue, 0);
                const totalRegionalOutput = Object.values(currentData).reduce((sum, d) => sum + d.regionalOutput, 0);
                const totalTax = Object.values(currentData).reduce((sum, d) => sum + d.employeeTax, 0);
                const finalWorkforce = currentData['2031'].workforce;

                document.getElementById('kpi-capex').textContent = formatCurrencyIDR(baseData['2025'].capex);
                document.getElementById('kpi-workforce').textContent = formatNumber(finalWorkforce);
                document.getElementById('kpi-export').textContent = formatCurrencyIDR(totalExport);
                document.getElementById('kpi-tax').textContent = formatCurrencyIDR(totalTax);
                document.getElementById('kpi-multiplier').textContent = formatCurrencyIDR(totalRegionalOutput);

                createTrendChart(currentData, lang);
                createWorkforceChart(currentData['2031'], lang);
                createExportChart(currentData['2031'], lang);
            } else {
                const dataForYear = currentData[year];
                if (!dataForYear) return;
                
                document.getElementById('kpi-capex').textContent = formatCurrencyIDR(baseData['2025'].capex);
                document.getElementById('kpi-workforce').textContent = formatNumber(dataForYear.workforce);
                document.getElementById('kpi-export').textContent = formatCurrencyIDR(dataForYear.exportValue);
                document.getElementById('kpi-tax').textContent = formatCurrencyIDR(dataForYear.employeeTax);
                document.getElementById('kpi-multiplier').textContent = formatCurrencyIDR(dataForYear.regionalOutput);

                createTrendChart(currentData, lang);
                createWorkforceChart(dataForYear, lang);
                createExportChart(dataForYear, lang);
            }
        };

        const setLanguage = (lang) => {
            const t = translations[lang];
            document.documentElement.lang = lang;
            // Update all static text elements
            document.getElementById('dashboard-title').innerText = t.dashboardTitle;
            document.getElementById('company-name').innerText = t.companyName;
            document.getElementById('filter-title').innerText = t.filterTitle;
            document.getElementById('year-label').innerText = t.yearLabel;
            document.getElementById('year-option-all').innerText = t.yearOptionAll;
            document.getElementById('scenario-label').innerText = t.scenarioLabel;
            document.getElementById('scenario-baseline').innerText = t.scenarioBaseline;
            document.getElementById('scenario-optimistic').innerText = t.scenarioOptimistic;
            document.getElementById('scenario-conservative').innerText = t.scenarioConservative;
            document.getElementById('kpi-capex-title').innerText = t.kpiCapexTitle;
            document.getElementById('kpi-capex-subtitle').innerText = t.kpiCapexSubtitle;
            document.getElementById('kpi-workforce-title').innerText = t.kpiWorkforceTitle;
            document.getElementById('kpi-workforce-subtitle').innerText = t.kpiWorkforceSubtitle;
            document.getElementById('kpi-export-title').innerText = t.kpiExportTitle;
            document.getElementById('kpi-export-subtitle').innerText = t.kpiExportSubtitle;
            document.getElementById('kpi-tax-title').innerText = t.kpiTaxTitle;
            document.getElementById('kpi-tax-subtitle').innerText = t.kpiTaxSubtitle;
            document.getElementById('kpi-multiplier-title').innerText = t.kpiMultiplierTitle;
            document.getElementById('kpi-multiplier-subtitle').innerText = t.kpiMultiplierSubtitle;
            document.getElementById('chart-trend-title').innerText = t.chartTrendTitle;
            document.getElementById('chart-workforce-title').innerText = t.chartWorkforceTitle;
            document.getElementById('chart-export-title').innerText = t.chartExportTitle;
            // After setting text, re-render dashboard to update charts
            updateDashboard();
        }

        document.addEventListener('DOMContentLoaded', () => {
            setLanguage('id'); // Set default on load
            document.getElementById('year-filter').addEventListener('change', updateDashboard);
            document.getElementById('scenario-filter').addEventListener('change', updateDashboard);
            document.getElementById('language-selector').addEventListener('change', (e) => setLanguage(e.target.value));
        });
    </script>
</body>
</html>
